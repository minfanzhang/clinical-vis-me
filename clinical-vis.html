<!--
@license
Copyright 2018 Google Inc.
Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at
    http://www.apache.org/licenses/LICENSE-2.0
Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

http://localhost:8081/components/clinical-vis/demo/index.html
http://localhost:8081/components/clinical-vis/demo/table-index.html
-->

<!--
$.getJSON('http://soundcloud.com/oembed?url=http%3A//soundcloud.com/forss/flickermood&format=js&callback=?', function(data) {
    console.log(data);
});

$.getJSON('http://lore-api.sickkids.ca/api/data?measure=157&patient=2673678&starttime=1464725335.68&endtime=1464725336', function(data) {
    console.log(data);
});
-->

<link rel="import" href="../polymer/polymer.html">
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i" rel="stylesheet">
<dom-module id="clinical-vis">
  <template>
    <style>
      :host{
        font-family: 'Roboto', sans-serif;
        font-size: 13sp;
        line-height: 1.2em;
      }
      body {
        margin: 0px;
        background: #fcfcfc;
      }
      .basic-data {
        min-width: 220px;
        width: 220px;
        float: left;
        box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
        margin-right: 24px;
        border-radius: 3px;
        }
      .basic-data-heading {
        background: #E3EEEF;
        font-weight: 400;
        color: #26272A;
        padding: 6px;
        font-size: 10pt;
        border-bottom: solid 3px #c0dadc;
      }
      .basic-data-pair {
        display: block;
        margin: 4px;
        padding: 4px;
      }
      .basic-data-key {
        font-size: 10pt;
        line-height: 1.2em;
        font-weight: 300;
        padding-left: 4px;
        color: #356266;
      }
      .basic-data-value {
        font-size: 11pt;
        line-height: 1.4em;
        padding: 4px;
        color: #232321;
        font-weight: 400;
        hyphens: auto;
      }
      .cat-holder {
        font-size: 16sp;
        font-weight: 300;
        color: #0063A3;
      }
      .key-and-chart-holder {
        display: flex;
        font-size: 14sp;
        padding: 8px 0px;
        border-bottom: solid 2px #f2f3f5;
      }
      .bar-key-holder {
        padding: 20px;
        width: 120px;
        min-width: 120px;
        text-align: right;
        font-size: 16sp;
        font-weight: 400;
        color: #db5825;
      }
      .vitals-top-holder {
        display: flex;
      }
      .cat-holder-inner {
        padding: 20px;
        width: 120px;
        min-width: 120px;
        text-align: right;
        font-size: 16sp;
        font-weight: 400;
        color: #db5825;
      }
      .key-holder {
        width: 120px;
        min-width: 120px;
        font-weight: 400;
        color: #561f06;
        font-size: 10pt;
        text-align: right;
        padding: 10px;
      }
      .chart-holder {
        padding: 20px;
        width: 500px;
        flex-grow: 1;
        padding-bottom: 5px 0px;
      }
      .chart-holder-inner {
        width: 100%;
      }
      .xaxis-holder {
        margin-left: 190px;
        font-size: 8pt;
        color: #525251;
        border-bottom: solid 3px #D3DADB;
      }
      .vitals-axis-holder {
        margin-left: 30px;
        padding-top: 18px;
        font-size: 8pt;
        color: #525251;
        border-bottom: solid 3px #D3DADB;
        overflow: visible;
      }
      .heading-label {
        font-weight: 400;
        color: #F0F2F0;
        padding: 4px;
        font-size: 11pt;
      }
      .note-card {
        border: solid 1px #D3DADB;
        background: #F7FFF7;
        border-radius: 3px;
        margin: 0px 24px 24px 0px;
        min-width: 600px;
        width: 600px;
        box-shadow: 0 1px 3px rgba(4,28,2,0.12), 0 1px 2px rgba(0,2,0,0.24);
      }
      .note-heading {
        font-weight: 500;
        font-size: 16sp;
        background: #448e3d;
        color: #F0F2F0;
        padding: 6px;
      }
      .note-text {
        white-space: pre-wrap;
        border: solid 1px #191970;
        background: #fcfce4;
        color: #09096b;
        height: 250px;
        padding: 4px;
        overflow-y: auto;
      }
      .lab-card {
        border: solid 1px #D3DADB;
        background: #f7fdff;
        border-radius: 3px;
        margin: 0px 24px 24px 0px;
        min-width: 600px;
        width: 600px;
        box-shadow: 0 1px 3px rgba(2,22,25,0.12), 0 1px 2px rgba(0,6,7,0.24);
      }
      .lab-heading {
        font-weight: 500;
        font-size: 16sp;
        color: #F0F2F0;
        background: #1ca4bc;
        padding: 6px;
      }
      .selected-labs {
        padding-bottom: 24px;
        border-top: solid 3px #296671;
        min-height: 400px;
        height: 400px;
        overflow-y: scroll;
        resize: vertical;
      }
      .lab-key-and-value {
        display: flex;
        padding: 2px;
        font-size: 14px;
        border-bottom: solid 0.5px rgb(218, 229, 232);
        margin-bottom: 1px;
        height: 40px;
        line-height: 40px;
      }
      .lab-key {
        font-weight: 500;
        text-align: right;
        padding-right: 18px;
        min-width: 200px;
        width: 200px;
        color: #023a44;
        border-right: solid 1px rgba(218, 229, 232, 0.75);
      }
      .lab-value {
        min-width: 40px;
        width: 40px;
        text-align: right;
        color: #03697b;
      }
      .lab-units {
        min-width: 40px;
        width: 40px;
        font-size: 9pt;
        color: #75a2aa;
        padding-left: 3px;
        line-height: 44px;
      }
      .chart-units {
        font-size: 12px;
        color: #8C615A;
        padding-left: 3px;
        font-weight: 400;
        line-height: 1em;
      }
      .lab-sparkline {
        width: 120px;
        min-width:120px;
        margin: 6px 36px 6px auto;
      }
      .charts-and-labs {
        overflow: hidden;
      }
      .chart-card {
        border: 1px solid #D3DADB;
        border-radius: 3px;
        background: rgba(255, 251, 249,0.12);
        box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
        width: 99%;
        min-width: 35%;
        display: inline-block;
        vertical-align: top;
        position: relative;
      }
      .chart-card-heading {
        font-weight: 400;
        font-size: 16sp;
        color: #561f06;
        background: #ff0000;
        padding: 6px;
      }
      #chartstop {
        padding: 20px;
        overflow: auto;
        border-top: solid 3px #dc987a;
      }
      #textarea {
        font-family: 'Roboto', sans-serif;
        display: inline-block;
        vertical-align: top;
        position: relative;
      }
      .c3-ygrid-line {
        stroke: #D3DADB;
      }
      .c3-axis-y{
        font-family: 'Roboto', sans-serif;
        color: #26272A;
      }
      .c3 line {
        stroke: #D3DADB;
      }
      .c3 .domain {
        stroke: #D3DADB;
      }
      .limit-line line {
        stroke: rgba(204, 217, 172, 0.50);
        stroke-width: 3;
      }
      .lab-limit-line line {
        stroke: rgba(176, 193, 133, 0.50);
        stroke-width: 1.5;
      }
      .chart-holder-inner-bar {
        margin-left: 30px;
      }
      .xaxis-holder line {
        stroke: #525251;
      }
      .xaxis-holder .domain {
        display: none;
      }
      .vitals-axis-holder line {
        stroke: #525251;
      }
      .vitals-axis-holder .domain {
        display: none;
      }
      .c3-text {
        font-family: 'Roboto', sans-serif;
        font-weight: 400;
      }
      #table-holder-out {
        border: 1px solid #D3DADB;
        border-radius: 3px;
        background: rgba(255, 251, 249,0.12);
        box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
        width: 65%;
        min-width: 35%;
        display: inline-block;
        vertical-align: top;
        position: relative;
      }
      #notes-holder-out {
        border: 1px solid #D3DADB;
        border-radius: 3px;
        background: rgba(255, 251, 249,0.12);
        box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
        width: 65%;
        min-width: 35%;
        display: inline-block;
        vertical-align: top;
        position: relative;
      }
      #table-holder-out-heading {
        font-weight: 400;
        font-size: 16sp;
        color: #561f06;
        background: #ff0000;
        padding: 6px;
      }
      #tableholder {
        overflow-x: auto;
        margin-left: 0px;
      }
      thead th{
        border: solid 0.5px #ccd7e5;
        padding: 2px;
        height: 24px;
        font-size: 13px;
        background: #eff6ff;
      }
      thead th.fixed-normal {
        min-width: 250px;
        width: 250px;
      }
      td.fixed-normal {
        min-width: 250px;
        width: 250px;
      }
    </style>
    <div class="basic-data">
      <div class="basic-data-heading">Patient Information</div>
      <div class="basic-data-pair">
        <div class="basic-data-key">Name</div>
        <div class="basic-data-value">Tom Smith</div>
      </div>
      <div class="basic-data-pair">
        <div class="basic-data-key">Age</div>
        <div class="basic-data-value">65</div>
      </div>
      <div class="basic-data-pair">
        <div class="basic-data-key">Gender</div>
        <div class="basic-data-value">Male</div>
      </div>
      <div class="basic-data-pair">
        <div class="basic-data-key">Ethnicity</div>
        <div class="basic-data-value">White</div>
      </div>
      <div class="basic-data-pair">
        <div class="basic-data-key">Admitting Diagnosis</div>
        <div class="basic-data-value">N/A</div>
      </div>
      <div class="basic-data-pair">
        <div class="basic-data-key">ICU type</div>
        <div class="basic-data-value">N/A</div>
      </div>
    </div>

    <div id="table-holder-out">
      <div class="table-holder-out-heading">Static Variables</div>
      <div id="tableholder"></div>
    </div>

    <div id="notes-holder-out">
      <div class="table-holder-out-heading">Notes</div>
      <div id="notesholder">
        <div class="note-text">The patient is an 8 month old female with Trisomy 21 who was admitted 3 weeks ago with 
respiratory failure with low oxygen levels. Despite initial attempts at managing her respiratory failure with 
conventional breathing machine strategies, she continued to struggle and so ultimately required cannulation to 
ECMO in order to facilitate gas exhange. She was found to have an underlying virus along with a superimposed 
bacterial pneumonia. During the first two weeks of her hospitalization her blood pressure was occasionally low 
and she required additional medications and fluids. 

Since that time, she has slowly improved from a respiratory standpoint but still requires ECMO. She is fluid 
overloaded with acute kidney injury and has been on a diuretic infusion. She requires frequent electrolyte 
replacements. She was well-nourished prior to her illness but has not consistently been meeting her caloric and 
protein goals for a variety of reasons. She has had feeding intolerance and she has only inconsistently 
tolerated feeds in her intestines through the feeding tube, with the bulk of her nutrition coming from TPN. 
          
Using the current EPIC workflow on daily rounds, the following steps were required to ascertain her current fluid and 
nutrition status in order to inform the daily plan for her fluid goal and how to best achieve that goal while optimizing 
nutrition given current options and limitations. </div>
      </div>
    </div>

      <div class="chart-card">
        <div class="chart-card-heading">Graphs of Various Trends</div>
        <div id="chartstop"></div>
      </div>
    </div>
  </template>
  <script>
    const unitData = {
      'Albumin': {'units': 'g/dL', 'low': 3.5, 'high': 6},
      'Anion Gap': {'units': 'mEq/L'},
      'Bicarbonate': {'units': 'mEq/L', 'low': 22, 'high': 32},
      'Bilirubin': {'units': 'mg/dL', 'low': 0.1, 'high': 1.2},
      'Blood urea nitrogen': {'units': 'mEq/L', 'low': 6, 'high': 20},
      'Calcium': {'units': 'mg/dL', 'low': 8.4, 'high': 10.3},
      'Chloride': {'units': 'mEq/L', 'low': 96, 'high': 108},
      'Cholesterol': {'units': 'mg/dL', 'low': 40, 'high': 240},
      'Creatinine': {'units': 'mEq/L', 'low': 0.4, 'high': 1.1},
      'Diastolic blood pressure': {'units': 'mmHg', 'low': 60, 'high': 90},
      'Fraction inspired oxygen': {'units': '%'},
      'Glucose': {'units': 'mg/dL', 'low': 70, 'high': 105},
      'Heart Rate': {'units': 'bpm', 'low': 50, 'high': 100},
      'Hematocrit': {'units': '%', 'low': 37, 'high': 52},
      'Hemoglobin': {'units': 'g/dL', 'low': 11.2, 'high': 15.7},
      'Lactate': {'units': 'mmol/dL', 'low': .5, 'high': 2},
      'Lymphocytes': {'units': 'm/uL', 'low': 1, 'high': 3},
      'Magnesium': {'units': 'mg/dL', 'low': 1.6, 'high': 2.6},
      'Mean blood pressure': {'units': 'mmHg'},
      'Monocytes': {'units': 'M/uL', 'low': .2, 'high': 1},
      'Neutrophilis': {'units': 'M/uL', 'low': 2, 'high': 7},
      'Oxygen saturation': {'units': '%', 'low': 94, 'high': 100},
      'Partial pressure of CO2': {'units': 'mmHg', 'low': 38, 'high': 42},
      'Partial pressure of O2': {'units': 'mmHg', 'low': 75, 'high': 100},
      'pH': {'low': 7.35, 'high': 7.45},
      'Phosphate': {'units': 'mg/dL', 'low': 2.7, 'high': 4.5},
      'Platelets': {'units': 'K/uL', 'low': 150, 'high': 400},
      'Potassium': {'units': 'mEq/L', 'low': 3.3, 'high': 5.1},
      'Prothrombin time': {'units': 'secL', 'low': 11, 'high': 14},
      'Partial thromboplastin time': {'units': 'sec', 'low': 25, 'high': 35},
      'Red blood cell count': {'units': 'M/uL', 'low': 42, 'high': 6.1},
      'Respiratory rate': {'units': 'bpm', 'low': 12, 'high': 25},
      'Sodium': {'units': 'mEq/L', 'low': 133, 'high': 145},
      'Systolic blood pressure': {'units': 'mmHg', 'low': 95, 'high': 140},
      'Temperature': {'units': 'C', 'low': 36.6, 'high': 37},
      'Troponin-I': {'units': 'ng/mL'},
      'Troponin-T': {'units': 'ng/mL', 'low': 0, 'high': 0.01},
      'Urine output': {},
      'Weight': {'units': 'kg', 'low': 40, 'high': 240},
      'White blood cell count': {'units': 'K/uL', 'low': 5, 'high': 10},
    };
    Polymer({
      is: "clinical-vis",
      properties: {
        json: {tye: String, observer: 'jsonChanged'},
        noteTime: String,
        noteText: String,
        age: Number,
        selectedNoteIndex: Number,
        notesChart: Object,
      },
      getFakeName: function(gender) {
        return gender == 'M' ? 'John Doe' : 'Jane Doe';
      },
      getIcuName: function(icu) {
        if (icu == 'TSICU') {
          return 'Trauma ICU';
        }
        if (icu == 'CSRU') {
          return 'Cardiac Surgical Recovery Unit';
        }
        return icu;
      },
      getItemText: function(event) {
        const isNum = !isNaN(event.value) && event.value != '';
        if (isNum) {
          let num = parseFloat(event.value)
          return +num.toFixed(3);
        }
        return event.value;
      },
      getKeyUnits: function(key) {
        return unitData[key] && unitData[key].units ? unitData[key].units : null;
      },
      getKeyRange: function(key) {
        return unitData[key] && unitData[key].low ? [unitData[key].low, unitData[key].high] : null;
      },
      ListTimes: function(list, factor){
        let ret_list = []
        for (var i = 0; i < list.length; i++) {
          ret_list.push(list[i] * factor)
        }
        return ret_list
      },
      jsonChanged: function(json) {
        this.$.chartstop.innerHTML = '';
        console.log("json is ", json)
        this.generate_single_waveform(json.times, json.values);
        this.displayTimeTable();
        //this.displayNotes();
      },

      generate_single_waveform(Raw_X, Raw_Y) {
        //parsed_raw_x = JSON.parse(Raw_X);
        //console.log("rarsed Raw_X has type : ", parsed_raw_x)
        minX = Number.MAX_VALUE;
        maxX = 0;
        
        // X limit of the X-axis(hard coded for now)
        minX = Raw_X[0];
        maxX = Raw_X[Raw_X.length - 1];
        //minX = 6727662000;
        //maxX = 6727692600;

        // Pad one extra hour to ensure enough space for edge data points and their labels.
        //minX -= 60 * 60;
        //maxX += 60 * 60;
        this.minX = minX;
        this.maxX = maxX;
        const holder = d3.select(this.$.chartstop)

        const xAxisWidth = holder.node().getBoundingClientRect().width;
        const xAxisHeight = 20;

        const offsetToUTC = new Date(minX * 1000).getTimezoneOffset() * 60; // 14400
        const xScale = d3.time.scale()
                          .domain([new Date((minX + offsetToUTC) * 1000), new Date((maxX + offsetToUTC) * 1000)])
                          .rangeRound([0, xAxisWidth]);
        
        const xAxis = d3.svg.axis()
                            .orient('top')
                            .scale(xScale);


        // Initial generation of the UI
        dummay_currentCat = "dummy_Vitals";
        dummay_currentCatSelection = holder.append('div').classed('cat-holder', true);

        // Generate the heading division for the first chart
        const dummy_vitalsHeadingHolder = dummay_currentCatSelection.append('div');
        dummy_vitalsHeadingHolder.classed('vitals-top-holder', true);
        dummy_vitalsHeadingHolder.append('div').classed('cat-holder-inner', true).html("Time");
        const dummy_xAxisVis = dummy_vitalsHeadingHolder.append("svg:svg")
                               .attr('class', 'vitals-axis-holder')
                               .attr("width", xAxisWidth)
                               .attr("height", xAxisHeight)
                               .attr('overflow', 'auto');
        dummy_xAxisVis.append("g")
                .attr("class", "xaxis")
                .attr("transform", "translate(0," + xAxisHeight + ")")
                .call(xAxis.tickFormat(d3.timeFormat("%S:%L")).tickSize(-10));
        
        // Generate the key and chart division for the first chart
        const dummy_keyAndChartDiv = dummay_currentCatSelection.append('div').classed(
            'key-and-chart-holder', true);
        const dummy_chartUnits = "calorie";
        const dummy_chartRange = [7900, 8250];
        const dummy_chartTitleDiv = dummy_keyAndChartDiv.append('div');
        dummy_chartTitleDiv.classed('key-holder', true).html("TPN");
        dummy_chartTitleDiv.append('span').classed('chart-units', true).classed('lab-units', true).html('(' + dummy_chartUnits + ')');
        const dummy_chartDiv = dummy_keyAndChartDiv.append('div')
                                        .classed('chart-holder', true)
                                        .append('div')
                                        .classed('chart-holder-inner', true);

        // Generate the heading division for the second chart
        zoomChartHeadingHolder = dummay_currentCatSelection.append('div');
        zoomChartHeadingHolder.classed('vitals-top-holder', true);
        zoomChartHeadingHolder.append('div').classed('cat-holder-inner', true).html("Time(Zoom in)");

        zoomChartxAxisVis = zoomChartHeadingHolder.append("svg:svg")
                .attr('class', 'vitals-axis-holder')
                .attr("width", xAxisWidth)
                .attr("height", xAxisHeight)
                .attr('overflow', 'auto');

        // Generate the key and chart division for the second chart
        const zoomkeyAndChartDiv = dummay_currentCatSelection.append('div').classed(
            'key-and-chart-holder', true);
        const zoomchartUnits = "bpm";
        const zoomchartRange = [7900, 8250];
        const zoomchartTitleDiv = zoomkeyAndChartDiv.append('div');
        zoomchartTitleDiv.classed('key-holder', true).html("Heart Rate");
        zoomchartTitleDiv.append('span').classed('chart-units', true).classed('lab-units', true).html('(' + zoomchartUnits + ')');
        const zoomchartDiv = zoomkeyAndChartDiv.append('div')
                                        .classed('chart-holder', true)
                                        .append('div')
                                        .classed('chart-holder-inner', true);
    
        const dummy_x = ["time", 6727679100000, 6727680900000, 6727692600000, 6727662000000];
        const dummy_y = ["Heart Rate", 37.46, 37.34, 37.57, 37.57];
        //const dummy_x = ["time"].concat(this.ListTimes(Raw_X, 1000));
        //const dummy_y = ["Heart Rate"].concat(Raw_Y);
        const dummy_gridData = {y: {show: true}};
        dummy_gridData.y['lines'] = [
          {value: +dummy_chartRange[0], class: 'limit-line'},
          {value: +dummy_chartRange[1], class: 'limit-line'},
        ];

        const dummy_colorSelector = (color, d) => '#db5825';
        const dummy_chart = c3.generate({
          bindto: dummy_chartDiv,
          data: {
            x: 'time',
            xFormat: '%Y-%m-%dT%H:%M:%S.%LZ',
            columns: [dummy_x, dummy_y],
            labels: {
              format: (v, id, i, j) => +(+v).toFixed(2) + '',
            },
            color: dummy_colorSelector,
          },
          size: {
            height: 60,
          },
          axis: {
            x: {show: false, type: 'timeseries', localtime: false, min: minX * 1000, max: maxX * 1000},
            y: {show: true, tick: { count: 3, format: d3.format('.1f')}, padding: {top: 20, bottom: 6} }
          },
          legend: {
            show: false
          },
          grid: dummy_gridData,
        });

        // End of initial generation

        const dummy_buttomClickListener = (e) => {
          
          //const dummy_x_added = ["time", 6727679100000, 6727680900000, 6727692600000, 6727662000000];
          maxX_curr_wave = Raw_X[Raw_X.length - 1];
          minX_curr_wave = Raw_X[0];
          const dummy_x_added = ["time"].concat(this.ListTimes(Raw_X, 1000));
          let dummy_y_added;
          if (e.x === 0) {
            dummy_y_added = ["Heart Rate 1"].concat(Raw_Y);
          } 

          const dummy_colorSelector_range = function(color, d) {
              return '#01e925';
          }

          const dummy_chart_added = c3.generate({
            bindto: dummy_chartDiv,
            data: {
              x: 'time',
              xFormat: '%Y-%m-%dT%H:%M:%S.%LZ',
              columns: [dummy_x_added, dummy_y_added],
              labels: {
                format: function (v, id, i, j) {
                  return ''
                },
              },
              color: dummy_colorSelector_range,
            },
            size: {
              height: 60,
            },
            axis: {
              x: {show: false, type: 'timeseries', localtime: false,
               min: minX_curr_wave * 1000, max: maxX_curr_wave * 1000},
              y: {show: true, tick: { count: 3, format: d3.format('.1f')}, padding: {top: 20, bottom: 6} }
            },
            legend: {
              show: false
            },
            grid: dummy_gridData,
          });



        }

        const dummay_barDiv = dummay_currentCatSelection.append('div').classed('chart-holder', true)
            .append('div').classed('chart-holder-inner-bar', true).classed('chart-holder-inner', true);

        const dummy_colorButtonSelector = (color, d) => '#ff7fc5';
        const dummy_chart_selectButtons = c3.generate({
          bindto: dummay_barDiv,
          data: {
            columns: [
              ['data1', 5]
            ],
            types: {
              data1: 'bar',
            },
            color: dummy_colorButtonSelector,
            onclick: dummy_buttomClickListener,
          },
          size: {
            height: 20,
            width: 200
          },
          axis: {
            rotated: true,
            x: {
              show: true,
              type: 'category',
              categories: ['Generate graph']
            },
            y: {
              show: false
            }
          },
          legend: {
            show: false
          },
          tooltip: {
            show: false
          },
          bar: {
            width: 20
          },
        });


      },

      displayTimeTable: function() {
        d3.select(this.$.tableholder).html("");
        var table = d3.select(this.$.tableholder).append('table')
        var thead = table.append('thead')
        var tbody = table.append('tbody');
        const columns = ['Source', 'Item', 'Value']

        thead.append('tr')
          .selectAll('th')
          .data(columns).enter()
          .append('th')
            .text((column, i) => column)
            .classed('fixed-normal', true)

        allEvents = [{source: "Comprehensive flowsheet", item: "HR", value: "value of HR"},
                    {source: "Comprehensive flowsheet", item: "SBP", value: "value of SBP"},
                    {source: "Comprehensive flowsheet", item: "Specific hourly ins", value: "value of ins/h"},
                    {source: "Comprehensive flowsheet", item: "MAP", value: "value of MAP"},
                    {source: "Lines, drains, and airways", item: "Type of feeding tube in place", value: "tube type"}]

        var rows = tbody.selectAll('tr')
          .data(allEvents)
          .enter()
          .append('tr');

        var cells = rows.selectAll('td')
          .data(function (event) {
            return columns.map((column) => {
              if (column == 'Source') {
                return {column: column, value: event.source}
              }
              if (column == 'Item') {
                return {column: column, value: event.item};
              }
              if (column == 'Value') {
                return {column: column, value: event.value};
              }
            });
          })
          .enter()
          .append('td')
          .text((d) => d.value)
          .classed('fixed-normal', true)
        
      },

      displayNotes: function() {
        var notesholder = d3.select(this.$.notesholder);
        notesholder.html("");
        const enterSelection = notesholder.selectAll('div')
          .append('div').html('<div class="a">Note 1</div>');
        enterSelection.select('.a').text("Note 1");
      }




    });
  </script>
</dom-module>